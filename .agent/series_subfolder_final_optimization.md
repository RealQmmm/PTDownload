# åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹åŠŸèƒ½ - æœ€ç»ˆä¼˜åŒ–

## ä¼˜åŒ–å†…å®¹

### ä¼˜åŒ– 1ï¼šå»æ‰ä¸‹è½½ç•Œé¢æ‰€æœ‰å¡ç‰‡çš„å·¦è¾¹æ¡† âœ…

**ä¿®æ”¹æ–‡ä»¶ï¼š** `/client/src/pages/SettingsPage.jsx`

**æ”¹åŠ¨ï¼š**
- ç§»é™¤æ‰€æœ‰ `border-l-4 border-l-*` ç±»å
- ç»Ÿä¸€ä½¿ç”¨é»˜è®¤çš„ Card æ ·å¼ï¼Œä¸æ•´ä½“é£æ ¼ä¿æŒä¸€è‡´

**å½±å“çš„å¡ç‰‡ï¼š**
- é»˜è®¤ä¸‹è½½è·¯å¾„
- è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹
- å¤šè·¯å¾„ç®¡ç†
- æ™ºèƒ½åˆ†ç±»ç®¡ç†

**ä¹‹å‰ï¼š**
```jsx
<Card className="border-l-4 border-l-green-500">
<Card className="border-l-4 border-l-purple-500">
<Card className="border-l-4 border-l-blue-500">
<Card className="border-l-4 border-l-amber-500">
```

**ä¹‹åï¼š**
```jsx
<Card>
<Card>
<Card>
<Card>
```

---

### ä¼˜åŒ– 2ï¼šè¿½å‰§ç”Ÿæˆçš„è‡ªåŠ¨ RSS ä»»åŠ¡å—å¼€å…³æ§åˆ¶ âœ…

**ä¿®æ”¹æ–‡ä»¶ï¼š** `/server/src/services/seriesService.js`

**é—®é¢˜ï¼š**
ä¹‹å‰è¿½å‰§åŠŸèƒ½ä¼š**å›ºå®š**è‡ªåŠ¨åœ¨è·¯å¾„åæ·»åŠ å‰§é›†åç§°ä½œä¸ºå­æ–‡ä»¶å¤¹ï¼Œä¸å— `create_series_subfolder` å¼€å…³æ§åˆ¶ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
åœ¨åˆ›å»ºè¿½å‰§è®¢é˜…æ—¶ï¼Œæ£€æŸ¥ `create_series_subfolder` è®¾ç½®ï¼Œåªæœ‰å½“å¼€å…³å¯ç”¨æ—¶æ‰è‡ªåŠ¨æ·»åŠ å­æ–‡ä»¶å¤¹ã€‚

**ä¿®æ”¹å‰ï¼š**
```javascript
// Auto-append Series Name to path for unified directory structure
if (finalSavePath) {
    const safeName = pathUtils.sanitizeFilename(name);
    finalSavePath = pathUtils.join(finalSavePath, safeName);
}
```

**ä¿®æ”¹åï¼š**
```javascript
// Check if series subfolder creation is enabled
// Only auto-append series name if the setting is enabled
const setting = this._getDB().prepare("SELECT value FROM settings WHERE key = 'create_series_subfolder'").get();
const createSeriesSubfolder = setting?.value === 'true';

if (createSeriesSubfolder && finalSavePath) {
    const safeName = pathUtils.sanitizeFilename(name);
    finalSavePath = pathUtils.join(finalSavePath, safeName);
    console.log(`[Series] Auto-created subfolder for: ${name}`);
}
```

**æ•ˆæœï¼š**

**å¼€å…³å…³é—­æ—¶ï¼š**
```
åˆ›å»ºè¿½å‰§è®¢é˜…ï¼šThe Last of Us
ä¸‹è½½è·¯å¾„ï¼š/downloads/series
å®é™…ä¿å­˜è·¯å¾„ï¼š/downloads/series/
```

**å¼€å…³å¯ç”¨æ—¶ï¼š**
```
åˆ›å»ºè¿½å‰§è®¢é˜…ï¼šThe Last of Us
ä¸‹è½½è·¯å¾„ï¼š/downloads/series
å®é™…ä¿å­˜è·¯å¾„ï¼š/downloads/series/The Last of Us/
```

---

### ä¼˜åŒ– 3ï¼šé»˜è®¤ä¸‹è½½è·¯å¾„å’Œè‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹å¹¶æ’æ”¾ç½® âœ…

**ä¿®æ”¹æ–‡ä»¶ï¼š** `/client/src/pages/SettingsPage.jsx`

**æ”¹åŠ¨ï¼š**
å°†ä¸¤ä¸ªå¡ç‰‡æ”¾åœ¨åŒä¸€è¡Œï¼Œä½¿ç”¨ Grid å¸ƒå±€å¹¶æ’æ˜¾ç¤ºã€‚

**å¸ƒå±€ä»£ç ï¼š**
```jsx
{/* 0. é»˜è®¤ä¸‹è½½è·¯å¾„å’Œè‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹ (å¹¶æ’æ˜¾ç¤º) */}
<div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
    {/* é»˜è®¤ä¸‹è½½è·¯å¾„ */}
    <Card>
        <h3>ğŸ“‚ é»˜è®¤ä¸‹è½½è·¯å¾„</h3>
        <p>æ‰€æœ‰ä¸‹è½½ä»»åŠ¡é»˜è®¤ä½¿ç”¨çš„å­˜å‚¨è·¯å¾„...</p>
        <Input ... />
        <Button>ä¿å­˜</Button>
    </Card>

    {/* è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹ */}
    <Card>
        <h3>ğŸ“ è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹</h3>
        <p>æ£€æµ‹åˆ°ç§å­åç§°åŒ…å«å­£æ•°æ ‡è¯†...</p>
        <button>å¼€å…³</button>
    </Card>
</div>
```

**å“åº”å¼è®¾è®¡ï¼š**
- **å¤§å±å¹• (lg+)**: ä¸¤ä¸ªå¡ç‰‡å¹¶æ’æ˜¾ç¤º (`grid-cols-2`)
- **å°å±å¹•**: ä¸¤ä¸ªå¡ç‰‡å †å æ˜¾ç¤º (`grid-cols-1`)

**è§†è§‰æ•ˆæœï¼š**

**å¤§å±å¹•ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‚ é»˜è®¤ä¸‹è½½è·¯å¾„         â”‚  ğŸ“ è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹ â”‚
â”‚  [è¾“å…¥æ¡†]  [ä¿å­˜]       â”‚  [æè¿°]         [å¼€å…³]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å°å±å¹•ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‚ é»˜è®¤ä¸‹è½½è·¯å¾„         â”‚
â”‚  [è¾“å…¥æ¡†]  [ä¿å­˜]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹ â”‚
â”‚  [æè¿°]         [å¼€å…³]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å®Œæ•´åŠŸèƒ½æ€»ç»“

### è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹åŠŸèƒ½

**è§¦å‘æ¡ä»¶ï¼š**
- å¼€å…³å¯ç”¨ï¼š`create_series_subfolder = true`
- ç§å­åç§°åŒ…å«å­£æ•°æ ‡è¯†ï¼š`S01`, `S1`, `Season 1` ç­‰

**åº”ç”¨èŒƒå›´ï¼š**
1. âœ… **æ‰‹åŠ¨ä¸‹è½½** - åœ¨æœç´¢é¡µé¢ç‚¹å‡»ä¸‹è½½
2. âœ… **RSS è‡ªåŠ¨ä¸‹è½½** - RSS ä»»åŠ¡è‡ªåŠ¨åŒ¹é…ä¸‹è½½
3. âœ… **è¿½å‰§è®¢é˜…** - åˆ›å»ºè¿½å‰§è®¢é˜…æ—¶ç”Ÿæˆçš„ RSS ä»»åŠ¡

**è·¯å¾„ç”Ÿæˆé€»è¾‘ï¼š**

#### æ‰‹åŠ¨ä¸‹è½½ & RSS è‡ªåŠ¨ä¸‹è½½
```javascript
// æ£€æµ‹å­£æ•°æ ‡è¯†
if (episodeParser.hasSeasonIdentifier(title)) {
    // æå–å‰§é›†åç§°
    const seriesName = episodeParser.extractSeriesName(title);
    // æ‹¼æ¥è·¯å¾„
    savePath = pathUtils.join(savePath, seriesName);
}
```

#### è¿½å‰§è®¢é˜…
```javascript
// æ£€æŸ¥å¼€å…³
const createSeriesSubfolder = setting?.value === 'true';

if (createSeriesSubfolder && finalSavePath) {
    // ä½¿ç”¨è®¢é˜…åç§°ä½œä¸ºæ–‡ä»¶å¤¹å
    const safeName = pathUtils.sanitizeFilename(name);
    finalSavePath = pathUtils.join(finalSavePath, safeName);
}
```

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæ‰‹åŠ¨ä¸‹è½½å‰§é›†

**è®¾ç½®ï¼š**
- è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹ï¼šâœ… å¯ç”¨
- ä¸‹è½½è·¯å¾„ï¼š`/downloads/series`

**ç§å­ï¼š** `The.Last.of.Us.S01E05.2023.2160p.WEB-DL`

**ç»“æœï¼š**
```
ä¿å­˜è·¯å¾„ï¼š/downloads/series/The Last of Us/
```

---

### ç¤ºä¾‹ 2ï¼šRSS è‡ªåŠ¨ä¸‹è½½

**è®¾ç½®ï¼š**
- è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹ï¼šâœ… å¯ç”¨
- RSS ä»»åŠ¡ä¸‹è½½è·¯å¾„ï¼š`/downloads/variety`

**åŒ¹é…ç§å­ï¼š** `Running.Man.S2024E680.1080p.WEB-DL`

**ç»“æœï¼š**
```
ä¿å­˜è·¯å¾„ï¼š/downloads/variety/Running Man/
```

---

### ç¤ºä¾‹ 3ï¼šè¿½å‰§è®¢é˜…ï¼ˆå¼€å…³å¯ç”¨ï¼‰

**è®¾ç½®ï¼š**
- è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹ï¼šâœ… å¯ç”¨

**åˆ›å»ºè®¢é˜…ï¼š**
- å‰§é›†åç§°ï¼š`The Last of Us`
- å­£æ•°ï¼š`1`
- ä¸‹è½½è·¯å¾„ï¼š`/downloads/series`

**ç”Ÿæˆçš„ RSS ä»»åŠ¡ï¼š**
```
ä»»åŠ¡åç§°ï¼š[è¿½å‰§] The Last of Us S1
ä¿å­˜è·¯å¾„ï¼š/downloads/series/The Last of Us/
```

**ä¸‹è½½çš„æ–‡ä»¶ï¼š**
```
/downloads/series/The Last of Us/
â”œâ”€â”€ The.Last.of.Us.S01E01.mkv
â”œâ”€â”€ The.Last.of.Us.S01E02.mkv
â””â”€â”€ The.Last.of.Us.S01E03.mkv
```

---

### ç¤ºä¾‹ 4ï¼šè¿½å‰§è®¢é˜…ï¼ˆå¼€å…³å…³é—­ï¼‰

**è®¾ç½®ï¼š**
- è‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹ï¼šâŒ å…³é—­

**åˆ›å»ºè®¢é˜…ï¼š**
- å‰§é›†åç§°ï¼š`The Last of Us`
- å­£æ•°ï¼š`1`
- ä¸‹è½½è·¯å¾„ï¼š`/downloads/series`

**ç”Ÿæˆçš„ RSS ä»»åŠ¡ï¼š**
```
ä»»åŠ¡åç§°ï¼š[è¿½å‰§] The Last of Us S1
ä¿å­˜è·¯å¾„ï¼š/downloads/series/
```

**ä¸‹è½½çš„æ–‡ä»¶ï¼š**
```
/downloads/series/
â”œâ”€â”€ The.Last.of.Us.S01E01.mkv
â”œâ”€â”€ The.Last.of.Us.S01E02.mkv
â”œâ”€â”€ The.Last.of.Us.S01E03.mkv
â”œâ”€â”€ Running.Man.S2024E680.mkv
â””â”€â”€ Planet.Earth.II.S01E01.mkv
```

---

## æ—¥å¿—è¾“å‡º

### æ‰‹åŠ¨ä¸‹è½½
```
[Series Subfolder] Created subfolder for: The Last of Us
```

### RSS è‡ªåŠ¨ä¸‹è½½
```
[RSS][Series Subfolder] Using subfolder: The Last of Us
```

### è¿½å‰§è®¢é˜…
```
[Series] Auto-created subfolder for: The Last of Us
```

---

## ä¼˜åŒ–å‰åå¯¹æ¯”

### UI å¸ƒå±€

**ä¼˜åŒ–å‰ï¼š**
- å¡ç‰‡æœ‰å½©è‰²å·¦è¾¹æ¡†ï¼ˆç»¿è‰²ã€ç´«è‰²ã€è“è‰²ã€ç¥ç€è‰²ï¼‰
- é»˜è®¤ä¸‹è½½è·¯å¾„å’Œè‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹åˆ†åˆ«å ä¸€è¡Œ
- è§†è§‰é£æ ¼ä¸ç»Ÿä¸€

**ä¼˜åŒ–åï¼š**
- æ‰€æœ‰å¡ç‰‡ä½¿ç”¨ç»Ÿä¸€æ ·å¼ï¼Œæ— å·¦è¾¹æ¡†
- é»˜è®¤ä¸‹è½½è·¯å¾„å’Œè‡ªåŠ¨åˆ›å»ºå‰§é›†å­æ–‡ä»¶å¤¹å¹¶æ’æ˜¾ç¤º
- è§†è§‰é£æ ¼ç»Ÿä¸€ï¼Œæ›´ç®€æ´

### è¿½å‰§åŠŸèƒ½

**ä¼˜åŒ–å‰ï¼š**
- è¿½å‰§è®¢é˜…**å›ºå®š**åˆ›å»ºå­æ–‡ä»¶å¤¹
- æ— æ³•é€šè¿‡å¼€å…³æ§åˆ¶
- ä¸æ‰‹åŠ¨ä¸‹è½½/RSS ä¸‹è½½çš„è¡Œä¸ºä¸ä¸€è‡´

**ä¼˜åŒ–åï¼š**
- è¿½å‰§è®¢é˜…å— `create_series_subfolder` å¼€å…³æ§åˆ¶
- è¡Œä¸ºä¸æ‰‹åŠ¨ä¸‹è½½/RSS ä¸‹è½½ä¿æŒä¸€è‡´
- ç”¨æˆ·å¯ä»¥ç»Ÿä¸€æ§åˆ¶æ‰€æœ‰ä¸‹è½½æ–¹å¼çš„å­æ–‡ä»¶å¤¹åˆ›å»º

---

## æ€»ç»“

âœ… **ä¼˜åŒ– 1 å®Œæˆ** - å»æ‰æ‰€æœ‰å¡ç‰‡å·¦è¾¹æ¡†ï¼Œç»Ÿä¸€é£æ ¼
âœ… **ä¼˜åŒ– 2 å®Œæˆ** - è¿½å‰§è®¢é˜…å—å¼€å…³æ§åˆ¶
âœ… **ä¼˜åŒ– 3 å®Œæˆ** - ä¸¤ä¸ªå¡ç‰‡å¹¶æ’æ˜¾ç¤º

**åŠŸèƒ½å·²å®Œå…¨ä¼˜åŒ–å¹¶éƒ¨ç½²ï¼** ğŸ‰

æ‰€æœ‰ä¸‹è½½æ–¹å¼ï¼ˆæ‰‹åŠ¨ã€RSSã€è¿½å‰§ï¼‰ç°åœ¨éƒ½ç»Ÿä¸€å— `create_series_subfolder` å¼€å…³æ§åˆ¶ï¼Œç”¨æˆ·ä½“éªŒæ›´åŠ ä¸€è‡´å’Œå¯æ§ã€‚
