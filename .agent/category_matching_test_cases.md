# 类型字段匹配测试用例

## 测试目的
验证 `normalizeCategory` 函数能够正确处理各种格式的类型输入，包括中文、英文、大小写、复数等。

## 测试用例

### 1. 中文类型（直接匹配）

| 输入 | 预期输出 | 说明 |
|------|---------|------|
| 电影 | 电影 | 中文完全匹配 |
| 剧集 | 剧集 | 中文完全匹配 |
| 动画 | 动画 | 中文完全匹配 |
| 音乐 | 音乐 | 中文完全匹配 |

### 2. 英文类型（别名匹配）

| 输入 | 预期输出 | 匹配的别名 |
|------|---------|-----------|
| Movie | 电影 | movie |
| Movies | 电影 | movie (包含匹配) |
| Film | 电影 | film |
| TV | 剧集 | tv |
| Series | 剧集 | series |
| TV Series | 剧集 | tv (部分匹配) |
| Anime | 动画 | anime |
| Music | 音乐 | music |
| Documentary | 纪录片 | documentary |
| Software | 软件 | software |
| Game | 游戏 | game |
| Games | 游戏 | game (包含匹配) |
| Sport | 体育 | sport |
| Sports | 体育 | sport (包含匹配) |

### 3. 大小写变体

| 输入 | 预期输出 | 说明 |
|------|---------|------|
| MOVIE | 电影 | 全大写 |
| movie | 电影 | 全小写 |
| Movie | 电影 | 首字母大写 |
| MoViE | 电影 | 混合大小写 |

### 4. 类型ID（数字）

| 输入 | 预期输出 | 说明 |
|------|---------|------|
| 401 | 电影 | 电影类型ID |
| 402 | 电影 | 电影类型ID |
| 411 | 剧集 | 剧集类型ID |
| 421 | 动画 | 动画类型ID |
| 431 | 音乐 | 音乐类型ID |
| 499 | 其他 | 其他类型ID |

### 5. 带空格的输入

| 输入 | 预期输出 | 说明 |
|------|---------|------|
| " Movie " | 电影 | 前后有空格 |
| "  TV  " | 剧集 | 多个空格 |
| "TV Show" | 剧集 | 中间有空格（匹配 tv） |

### 6. 特殊格式

| 输入 | 预期输出 | 说明 |
|------|---------|------|
| BluRay | 电影 | 蓝光格式 |
| BD | 电影 | 蓝光缩写 |
| DVD | 电影 | DVD格式 |
| MP3 | 音乐 | 音频格式 |
| FLAC | 音乐 | 无损音频 |
| OVA | 动画 | 动画类型 |

### 7. 中文变体

| 输入 | 预期输出 | 说明 |
|------|---------|------|
| 动漫 | 动画 | 动画的别称 |
| 番剧 | 动画 | 动画的别称 |
| 美剧 | 剧集 | 剧集的子类 |
| 日剧 | 剧集 | 剧集的子类 |
| 韩剧 | 剧集 | 剧集的子类 |
| 真人秀 | 综艺 | 综艺的子类 |
| 电子书 | 学习 | 学习资源 |

### 8. 未知类型（回退处理）

| 输入 | 预期输出 | 说明 |
|------|---------|------|
| Unknown | Unknown | 首字母大写 |
| special | Special | 首字母大写 |
| custom | Custom | 首字母大写 |
| 未分类 | 未分类 | 保持原样 |

### 9. 边界情况

| 输入 | 预期输出 | 说明 |
|------|---------|------|
| "" (空字符串) | "" | 返回空字符串 |
| null | "" | 返回空字符串 |
| undefined | "" | 返回空字符串 |
| "   " (纯空格) | "" | trim后为空 |

### 10. 复杂组合

| 输入 | 预期输出 | 匹配逻辑 |
|------|---------|---------|
| "Movie / Film" | 电影 | 包含 "movie" |
| "TV Drama" | 剧集 | 包含 "tv" |
| "Anime Series" | 动画 | 包含 "anime" |
| "Music Album" | 音乐 | 包含 "music" |
| "Documentary Film" | 纪录片 | 包含 "documentary" |

## 匹配算法说明

### 双向包含匹配
```javascript
cat.includes(alias) || alias.includes(cat)
```

**优势**：
1. 支持完全匹配：`"movie"` 匹配 `"movie"`
2. 支持复数形式：`"movies"` 包含 `"movie"`
3. 支持缩写：`"mov"` 被 `"movie"` 包含
4. 支持组合：`"tv show"` 包含 `"tv"`

**注意事项**：
- 匹配是**不区分大小写**的（已转小写）
- 匹配是**包含匹配**，不是精确匹配
- 第一个匹配的类型会被返回（顺序重要）

## 实际应用场景

### 场景 1：中文PT站点
```
网站类型字段: "电影"
处理结果: "电影"
显示: 🎬 电影 (紫色标签)
```

### 场景 2：英文PT站点
```
网站类型字段: "Movie"
处理结果: "电影"
显示: 🎬 电影 (紫色标签)
```

### 场景 3：使用类型ID的站点
```
网站类型字段: "401"
处理结果: "电影"
显示: 🎬 电影 (紫色标签)
```

### 场景 4：混合格式站点
```
网站类型字段: "TV Series"
处理结果: "剧集"
显示: 📺 剧集 (粉色标签)
```

## 扩展建议

### 如果需要支持更多别名

在 `siteParsers.js` 的 `categoryMap` 中添加：

```javascript
const categoryMap = {
    '电影': [
        '电影', 'movie', 'movies', 'film', 'films', 
        'bluray', 'bd', 'dvd',
        'cinema',           // 新增
        'motion picture',   // 新增
        'feature film',     // 新增
        '401', '402', '403', '404', '405'
    ],
    // ... 其他类型
};
```

### 如果需要添加新类型

```javascript
const categoryMap = {
    // ... 现有类型
    '有声书': ['有声书', 'audiobook', 'audio book', 'spoken', '501', '502']
};
```

## 总结

✅ **完全支持英文类型**
✅ **支持中英文混合**
✅ **支持类型ID**
✅ **大小写不敏感**
✅ **灵活的包含匹配**
✅ **良好的容错性**
