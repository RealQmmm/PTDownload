# ✅ 智能下载子选项配置已上线

## 功能概述

在智能下载开关下方添加了 4 个子选项，允许用户按需开启或关闭特定的匹配策略和兜底方案。

## 子选项功能说明

用户可以在 **⚙️ 设置 → 🏷️ 类型映射** 中看到以下子选项（仅在开启智能下载后显示）：

1.  **类型精确匹配** (`match_by_category`)
    *   **启用时**：优先使用 PT 站点提供的 `category` 字段直接匹配同名的下载路径。
    *   **场景**：PT 站分类准确，且本地路径名称与 PT 站分类一致。

2.  **关键词评分匹配** (`match_by_keyword`)
    *   **启用时**：通过解析种子标题中的关键词（如 `S01`, `BluRay`, `FLAC`）进行智能评分。
    *   **场景**：PT 站分类不准确或无分类，依赖标题特征识别资源类型。

3.  **使用默认路径兜底** (`fallback_to_default_path`)
    *   **启用时**：如果前两个策略都未匹配到路径，尝试查找名为 `其他`, `默认`, `default`, `other` 的路径。
    *   **场景**：希望未识别的资源进入特定的"其他"目录，而不是随机进入某个目录。

4.  **使用首个路径兜底** (`fallback_to_first_path`)
    *   **启用时**：如果前面所有策略都失败，强制使用列表中的第一个路径。
    *   **关闭时**：如果前面所有策略都失败，则返回空路径（即使用下载客户端的默认下载目录）。
    *   **场景**：如果不希望资源进入客户端默认目录，请开启此项。

## 配置组合建议

### ✅ 推荐配置（默认）
*   [x] 类型精确匹配
*   [x] 关键词评分匹配
*   [x] 使用默认路径兜底
*   [x] 使用首个路径兜底

**效果**：最大程度保证资源能被分配到一个最合理的路径，即使无法识别也会进入默认或第一个路径。

### 🎯 严格模式（仅精确匹配）
*   [x] 类型精确匹配
*   [ ] 关键词评分匹配
*   [x] 使用默认路径兜底
*   [ ] 使用首个路径兜底

**效果**：只信任 PT 站的分类。如果分类不匹配，则进入默认路径。如果连默认路径都没有，则使用客户端默认目录。

### 🤖 智能模式（依赖标题识别）
*   [ ] 类型精确匹配
*   [x] 关键词评分匹配
*   [x] 使用默认路径兜底
*   [x] 使用首个路径兜底

**效果**：忽略 PT 站分类（防止分类错误），完全依赖标题内容进行智能分析。

## 技术实现细节

1.  **数据库**：在 `settings` 表中添加了 `match_by_category`, `match_by_keyword` 等 4 个键。
2.  **前端 UI**：SettingsPage 中添加了子选项 UI，当总开关开启时显示。
3.  **核心逻辑**：`pathUtils.js` 中的 `suggestPathByTorrentName` 函数现在接收 `options` 对象，根据传入的开关决定是否执行特定的逻辑块。
4.  **调用**：SearchPage 在点击下载时，从 Settings 中读取这些配置并传递给 `suggestPathByTorrentName`。

## 部署状态

*   ✅ 数据库配置更新
*   ✅ 设置页面 UI 更新
*   ✅ 核心路径算法更新
*   ✅ Docker 容器已重建并运行

## 下一步

用户现在可以完全控制智能下载的决策过程，根据自己的需求调整匹配策略。
